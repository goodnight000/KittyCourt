# Server Environment Variables
# Copy this to .env and fill in your values

# OpenRouter API (Main Judge - Kimi K2 Thinking)
OPENROUTER_API_KEY=your_openrouter_api_key_here

# OpenAI API (Embeddings + Extraction Agent + Moderation)
OPENAI_API_KEY=your_openai_api_key_here

# Supabase Configuration (Hybrid Memory Matrix)
# Get these from your Supabase project settings
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_KEY=your-supabase-service-role-key

# Redis Configuration (Court Session Persistence)
# REQUIRED in production for session persistence across server restarts
# Without Redis, court sessions are stored in-memory only and will be lost on restart
# Example: REDIS_URL=redis://localhost:6379
# Or use: REDIS_HOST=localhost and REDIS_PORT=6379
REDIS_URL=

# Feature flags
XP_SYSTEM_ENABLED=false

# Memory jobs runtime (queue + worker orchestration)
# Queue-only mode is the default and legacy inline extraction fallbacks are retired.
# MEMORY_QUEUE_ONLY=true means API trigger paths enqueue jobs only.
# Queue-only operation requires either:
# - MEMORY_JOBS_WORKER_ENABLED=true (embedded worker in API process), or
# - MEMORY_JOBS_WORKER_EXTERNAL=true (standalone worker process expected)
MEMORY_QUEUE_ONLY=true
MEMORY_JOBS_WORKER_ENABLED=false
MEMORY_JOBS_WORKER_EXTERNAL=true
# Poll interval for memory jobs worker loops (positive integer, milliseconds)
MEMORY_JOBS_POLL_INTERVAL_MS=1000

# Optional: Server Configuration
PORT=3000
NODE_ENV=development

# CORS allowlist (comma-separated). In production this should be set explicitly.
# Examples:
#   CORS_ORIGIN=https://yourapp.com
#   CORS_ORIGIN=http://localhost:5173,capacitor://localhost
CORS_ORIGIN=

# Webhook shared secret (required in production)
REVENUECAT_WEBHOOK_TOKEN=

# RevenueCat REST API secret key (required for server-side verification)
REVENUECAT_SECRET_KEY=

# Optional: request/body and upstream timeouts
JSON_BODY_LIMIT=256kb
OPENROUTER_TIMEOUT_MS=60000
OPENAI_MODERATION_TIMEOUT_MS=15000

# OpenRouter privacy routing controls
# data_collection:
# - deny (recommended): routes only to providers with no-training/no-collection setting
# - allow: provider default behavior
OPENROUTER_DATA_COLLECTION=deny
# Require Zero Data Retention providers only (strict; may reduce model availability)
OPENROUTER_ZDR=false

# Sentry (error + performance monitoring)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_RELEASE=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0

# Firebase Cloud Messaging (Push Notifications)
# Option 1: Path to service account JSON file
FIREBASE_SERVICE_ACCOUNT_PATH=./firebase-service-account.json
# Option 2: Inline credentials (use if not using file path)
# FIREBASE_PROJECT_ID=your_project_id
# FIREBASE_CLIENT_EMAIL=your_client_email@your_project.iam.gserviceaccount.com
# FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# Data Export (Storage + Email)
# Supabase Storage bucket for exports (must exist)
EXPORT_BUCKET=user-exports
# Signed URL TTL in seconds (default 7 days)
EXPORT_URL_TTL_SECONDS=604800
# Email provider config (see DATA_EXPORT_EMAIL_SETUP.md)
EMAIL_PROVIDER=
EMAIL_FROM=
EMAIL_API_KEY=
